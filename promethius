helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
kubectl create namespace monitoring
helm upgrade -i prometheus prometheus-community/prometheus --namespace monitoring --set alertmanager.persistence.storageClass="aws-ebs-db" --set server.persistentVolume.storageClass="aws-ebs-db"
sleep 15
#identify the Prometheus Pod name, and create that as an environment variable.
export POD_NAME=$(kubectl get pods --namespace monitoring -l "app.kubernetes.io/name=prometheus,app.kubernetes.io/instance=prometheus" -o jsonpath="{.items[0].metadata.name}")
#To perform port forward
kubectl --namespace monitoring port-forward $POD_NAME 9090
# Alertmanager port forwarding to see the dashboard
export POD_NAME=$(kubectl get pods --namespace prometheus -l "app.kubernetes.io/name=alertmanager,app.kubernetes.io/instance=prometheus" -o jsonpath="{.items[0].metadata.name}")
kubectl --namespace prometheus port-forward $POD_NAME 9093
